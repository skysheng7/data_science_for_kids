# 🔮 Day 4 - Spell 5: Confidence Interval Casino Challenge

## 🎰 Welcome to the Greatest Statistical Bet Ever!

Step right up to the most exciting casino in the statistics world! You'll use your bootstrap data to place bets on where the true population mean lies. Will you hit the jackpot?

### 🎮 Casino Game Setup

**The Challenge:** Use your bootstrap results to create confidence intervals and bet whether the true population mean falls inside your range!

**🎰 How to Win:** Your confidence interval must "capture" the true population mean to win the jackpot!

### 📊 Preparing Your Bootstrap Data

```{r}
# 🎲 Enter your bootstrap data from the previous activity

# From your Bootstrap Bootcamp Relay Race
bootstrap_red <- ...     # Red candies from 20 bootstrap samples
bootstrap_blue <- ...    # Blue candies from 20 bootstrap samples  
bootstrap_green <- ...   # Green candies from 20 bootstrap samples
bootstrap_yellow <- ...  # Yellow candies from 20 bootstrap samples
bootstrap_orange <- ...  # Orange candies from 20 bootstrap samples

# Convert to proportions (divide by 20 since you did 20 samples)
red_prop <- bootstrap_red / 20
blue_prop <- bootstrap_blue / 20
green_prop <- bootstrap_green / 20
yellow_prop <- bootstrap_yellow / 20
orange_prop <- bootstrap_orange / 20

print("🎲 Your Bootstrap Proportions:")
print(paste("Red:", round(red_prop, 3)))
print(paste("Blue:", round(blue_prop, 3)))
print(paste("Green:", round(green_prop, 3)))
print(paste("Yellow:", round(yellow_prop, 3)))
print(paste("Orange:", round(orange_prop, 3)))
```

### 🔮 R Magic: Creating 1000 Bootstrap Samples

```{r}
# 🔮 Let's create a massive bootstrap distribution for red candies

# Recreate your original sample based on your first grab
original_red <- ...     # Enter your original red count
original_blue <- ...    # Enter your original blue count
original_green <- ...   # Enter your original green count
original_yellow <- ...  # Enter your original yellow count
original_orange <- ...  # Enter your original orange count

# Create the original sample vector
original_colors <- c(rep("Red", original_red),
                    rep("Blue", original_blue),
                    rep("Green", original_green),
                    rep("Yellow", original_yellow),
                    rep("Orange", original_orange))

print(paste("🎯 Original sample size:", length(original_colors)))

# Generate 1000 bootstrap samples
set.seed(123)  # For reproducible results
num_bootstraps <- 1000
bootstrap_red_props <- numeric(num_bootstraps)

for(i in 1:num_bootstraps) {
  # Sample 10 candies with replacement
  boot_sample <- sample(original_colors, 10, replace = TRUE)
  # Calculate red proportion
  bootstrap_red_props[i] <- sum(boot_sample == "Red") / 10
}

print("🔮 Bootstrap Distribution Created!")
print(paste("Mean of bootstrap distribution:", round(mean(bootstrap_red_props), 3)))
print(paste("Standard deviation:", round(sd(bootstrap_red_props), 3)))
```

### 📊 Visualizing Your Bootstrap Distribution

```{r}
# Create histogram of bootstrap distribution
hist(bootstrap_red_props, 
     breaks = 20,
     main = "🎰 Casino Bootstrap Distribution - Red Proportion",
     xlab = "Proportion of Red Candies",
     col = "lightcoral",
     border = "darkred")

# Add vertical line for mean
mean_prop <- mean(bootstrap_red_props)
abline(v = mean_prop, col = "red", lwd = 3)
text(mean_prop, max(hist(bootstrap_red_props, plot = FALSE)$counts) * 0.8, 
     paste("Mean:", round(mean_prop, 3)), pos = 4)
```

### 🎰 Confidence Interval Casino Bets

```{r}
# 🎰 Calculate different confidence intervals

# 90% Confidence Interval
ci_90 <- quantile(bootstrap_red_props, c(0.05, 0.95))
print("🎰 90% Confidence Interval:")
print(paste("Lower bound:", round(ci_90[1], 3)))
print(paste("Upper bound:", round(ci_90[2], 3)))
print(paste("Width:", round(ci_90[2] - ci_90[1], 3)))

# 95% Confidence Interval  
ci_95 <- quantile(bootstrap_red_props, c(0.025, 0.975))
print("🎰 95% Confidence Interval:")
print(paste("Lower bound:", round(ci_95[1], 3)))
print(paste("Upper bound:", round(ci_95[2], 3)))
print(paste("Width:", round(ci_95[2] - ci_95[1], 3)))

# 99% Confidence Interval
ci_99 <- quantile(bootstrap_red_props, c(0.005, 0.995))
print("🎰 99% Confidence Interval:")
print(paste("Lower bound:", round(ci_99[1], 3)))
print(paste("Upper bound:", round(ci_99[2], 3)))
print(paste("Width:", round(ci_99[2] - ci_99[1], 3)))
```

### 🎮 Place Your Casino Bets!

```{r}
# 🎮 Choose your confidence level and place your bet!

# Uncomment the level you want to bet on:
# chosen_ci <- ci_90
# chosen_ci <- ci_95
chosen_ci <- ci_99  # Change this to your choice

chosen_level <- 99  # Change this to match your choice (90, 95, or 99)

print(paste("🎰 YOU CHOSE:", chosen_level, "% CONFIDENCE INTERVAL"))
print(paste("🎯 Your bet: True red proportion is between", 
            round(chosen_ci[1], 3), "and", round(chosen_ci[2], 3)))

# Calculate your bet score
bet_width <- chosen_ci[2] - chosen_ci[1]
confidence_points <- ifelse(chosen_level == 90, 5,
                           ifelse(chosen_level == 95, 10, 15))

print(paste("🏆 Confidence Points:", confidence_points))
print(paste("🎯 Interval Width:", round(bet_width, 3)))
```

### 🎰 Casino Visualization

```{r}
# Create a beautiful casino-style plot
hist(bootstrap_red_props, 
     breaks = 30,
     main = paste("🎰 CASINO BET:", chosen_level, "% Confidence Interval"),
     xlab = "Red Proportion",
     col = "lightblue",
     border = "navy")

# Add confidence interval
abline(v = chosen_ci[1], col = "red", lwd = 3, lty = 2)
abline(v = chosen_ci[2], col = "red", lwd = 3, lty = 2)

# Shade the confidence interval
x_vals <- seq(chosen_ci[1], chosen_ci[2], length.out = 100)
y_vals <- rep(0, 100)
polygon(c(chosen_ci[1], x_vals, chosen_ci[2]), 
         c(0, y_vals, 0), 
         col = rgb(1, 0, 0, 0.3), border = NA)

# Add labels
text(mean(chosen_ci), max(hist(bootstrap_red_props, plot = FALSE)$counts) * 0.5,
     paste(chosen_level, "% CI\n[", round(chosen_ci[1], 3), ", ", 
           round(chosen_ci[2], 3), "]"), 
     col = "darkred", font = 2)
```

### 🎲 The Big Reveal (Teacher Section)

```{r}
# 🎲 Teacher will reveal the true population proportion
# This will be filled in during class when teacher counts the population bowl

true_red_proportion <- ...  # Teacher enters the actual proportion here

print("🎲 THE BIG REVEAL!")
print("=================")
print(paste("🌟 TRUE RED PROPORTION:", true_red_proportion))
print(paste("🎯 Your interval: [", round(chosen_ci[1], 3), ", ", 
            round(chosen_ci[2], 3), "]"))

# Check if you won!
won_bet <- (true_red_proportion >= chosen_ci[1]) & (true_red_proportion <= chosen_ci[2])

if(won_bet) {
  print("🎉 JACKPOT! YOU WON THE BET!")
  total_points <- confidence_points + 20  # Bonus for winning
  print(paste("🏆 Total Points:", total_points))
  print("🍬 Congratulations! You earn extra candy!")
} else {
  print("😅 Oh no! The true value fell outside your interval!")
  total_points <- confidence_points  # Still get points for trying
  print(paste("🏆 Total Points:", total_points))
  print("🎲 This happens sometimes - that's why it's not 100% confidence!")
}
```

### 📊 Casino Performance Analysis

```{r}
# Calculate how close you were
if(exists("true_red_proportion") && !is.na(true_red_proportion)) {
  
  distance_from_interval <- ifelse(won_bet, 0,
                                  min(abs(true_red_proportion - chosen_ci[1]),
                                      abs(true_red_proportion - chosen_ci[2])))
  
  print("📊 PERFORMANCE ANALYSIS:")
  print("========================")
  print(paste("🎯 Bet Outcome:", ifelse(won_bet, "WON", "LOST")))
  print(paste("🔍 Distance from interval:", round(distance_from_interval, 3)))
  print(paste("📏 Interval width:", round(bet_width, 3)))
  print(paste("🎰 Confidence level chosen:", chosen_level, "%"))
  
  # Performance rating
  if(won_bet) {
    print("⭐ RATING: Casino Champion!")
  } else if(distance_from_interval < 0.1) {
    print("⭐ RATING: Close Call - Almost won!")
  } else {
    print("⭐ RATING: Learning Experience - Try again!")
  }
}
```

### 🎯 Casino Challenges

**💡 Challenge 1: Strategy Question**
Which confidence level would you choose for:
- A medical study (need to be very sure)?
- A quick market survey (speed matters)?
- A space mission (absolutely must be right)?

**💡 Challenge 2: Trade-off Analysis**
Compare the three confidence levels:
- Which gives you the best chance of winning?
- Which gives you the most points if you win?
- Which is the narrowest interval?

**💡 Challenge 3: Real-World Casino**
How is this like real statistical research? What are scientists "betting" on?

### 🎉 Casino Championship Complete!

**🎰 Casino Winner Badge Earned:** You've mastered the art of statistical betting!

**🔍 Key Discovery:** 
- Higher confidence = wider intervals = better chance of "winning"
- Lower confidence = narrower intervals = more points but riskier
- Confidence intervals help us quantify uncertainty
- Even good intervals sometimes miss the true value!

**💡 Casino Wisdom:** 
- Being more confident requires casting a wider net
- There's always a trade-off between precision and certainty
- Statistics is about managing uncertainty, not eliminating it!

**🎊 Congratulations on completing the Statistical Casino Challenge!**

---

## 📝 Casino Notes

**Confidence Interval:** Range where we think the true value lies  
**Confidence Level:** How sure we are (90%, 95%, 99%)  
**Width Trade-off:** Higher confidence = wider interval  
**Bootstrap CI:** Uses bootstrap distribution to create interval  

**Casino Rules:**
- 90% CI: 5 points + 20 bonus if you win
- 95% CI: 10 points + 20 bonus if you win  
- 99% CI: 15 points + 20 bonus if you win

**Remember:** Even the best confidence intervals sometimes miss - that's why they're not called "certainty intervals"!