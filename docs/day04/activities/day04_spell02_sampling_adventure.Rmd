---
title: "🔮 Day 4 - Spell 2: The Great Creature Sampling Adventure"
output: html_document
---

## 💡 What is Sampling?
Imagine you want to know how many dragons live in the entire Enchanted Forest, but you can't count them all! So you explore small areas, count the dragons there, and use that to guess about the whole forest. That's sampling!

**🌲 Population** = All the creatures in the entire Enchanted Forest (everything we want to know about)  
**🔍 Sample** = The creatures we find in one small area we explore (the small group we actually study)  
**📊 Statistic** = Something we calculate using our sample (like "30% of creatures in our sample are dragons")  
**🎯 Inference** = Using our sample to make a conclusion about the whole population

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
library(ggplot2)
library(dplyr)
set.seed(123)  # For reproducible results
```

## 🐉 Our Magical Population: The Enchanted Forest
Let's create our population of 1000 magical creatures where exactly 30% are dragons!

```{r create-population}
# Create our population of 1000 creatures
# 300 dragons (30%) and 700 other creatures (70%)
population <- data.frame(
  creature_id = 1:1000,
  creature_type = c(rep("dragon", 300), rep("other", 700))
)

# Let's verify our true population proportion
true_dragon_proportion <- sum(population$creature_type == "dragon") / nrow(population)
print(paste("🎯 True proportion of dragons in population:", true_dragon_proportion))

# Visualize our population
population_summary <- population %>%
  count(creature_type) %>%
  mutate(proportion = n / sum(n))

ggplot(population_summary, aes(x = creature_type, y = proportion, fill = creature_type)) +
  geom_bar(stat = "identity") +
  scale_fill_manual(values = c("dragon" = "red", "other" = "gray")) +
  labs(title = "🌲 True Population: Enchanted Forest Creatures",
       x = "Creature Type", 
       y = "Proportion",
       subtitle = "Population Size: 1000 creatures, 30% dragons") +
  theme_minimal() +
  theme(legend.position = "none")
```

## 🎣 Experiment 1: Small Samples (Size 10)
Let's take many small samples and see what happens!

```{r small-samples}
# Function to take a random sample and calculate dragon proportion
take_sample <- function(population, sample_size) {
  sample_data <- population[sample(nrow(population), sample_size), ]
  dragon_count <- sum(sample_data$creature_type == "dragon")
  proportion <- dragon_count / sample_size
  return(proportion)
}

# Take 100 samples of size 10
n_samples <- 100
sample_size_10 <- 10

sample_proportions_10 <- replicate(n_samples, take_sample(population, sample_size_10))

# Create a data frame for plotting
results_10 <- data.frame(
  sample_number = 1:n_samples,
  proportion = sample_proportions_10,
  sample_size = paste("Sample Size:", sample_size_10)
)

# Plot the sampling distribution
ggplot(results_10, aes(x = proportion)) +
  geom_histogram(bins = 15, fill = "lightblue", color = "black", alpha = 0.7) +
  geom_vline(xintercept = true_dragon_proportion, color = "red", linetype = "dashed", linewidth = 1) +
  labs(title = "🎲 Sampling Distribution: Sample Size 10",
       x = "Sample Proportion of Dragons", 
       y = "Frequency",
       subtitle = "Red line shows true population proportion (0.30)") +
  theme_minimal()

# Calculate statistics about our sampling distribution
mean_proportion_10 <- mean(sample_proportions_10)
sd_proportion_10 <- sd(sample_proportions_10)

print(paste("📊 Average of sample proportions (size 10):", round(mean_proportion_10, 3)))
print(paste("📏 Spread (standard deviation) of sample proportions:", round(sd_proportion_10, 3)))
```

## 🎣 Experiment 2: Medium Samples (Size 50)
What happens when we use bigger samples?

```{r medium-samples}
# Take 100 samples of size 50
sample_size_50 <- 50
sample_proportions_50 <- replicate(n_samples, take_sample(population, sample_size_50))

results_50 <- data.frame(
  sample_number = 1:n_samples,
  proportion = sample_proportions_50,
  sample_size = paste("Sample Size:", sample_size_50)
)

# Plot the sampling distribution
ggplot(results_50, aes(x = proportion)) +
  geom_histogram(bins = 15, fill = "lightgreen", color = "black", alpha = 0.7) +
  geom_vline(xintercept = true_dragon_proportion, color = "red", linetype = "dashed", linewidth = 1) +
  labs(title = "🎯 Sampling Distribution: Sample Size 50",
       x = "Sample Proportion of Dragons", 
       y = "Frequency",
       subtitle = "Red line shows true population proportion (0.30)") +
  theme_minimal()

# Calculate statistics
mean_proportion_50 <- mean(sample_proportions_50)
sd_proportion_50 <- sd(sample_proportions_50)

print(paste("📊 Average of sample proportions (size 50):", round(mean_proportion_50, 3)))
print(paste("📏 Spread (standard deviation) of sample proportions:", round(sd_proportion_50, 3)))
```

## 🎣 Experiment 3: Large Samples (Size 100)
Let's try even bigger samples!

```{r large-samples}
# Take 100 samples of size 100
sample_size_100 <- 100
sample_proportions_100 <- replicate(n_samples, take_sample(population, sample_size_100))

results_100 <- data.frame(
  sample_number = 1:n_samples,
  proportion = sample_proportions_100,
  sample_size = paste("Sample Size:", sample_size_100)
)

# Plot the sampling distribution
ggplot(results_100, aes(x = proportion)) +
  geom_histogram(bins = 15, fill = "lightcoral", color = "black", alpha = 0.7) +
  geom_vline(xintercept = true_dragon_proportion, color = "red", linetype = "dashed", linewidth = 1) +
  labs(title = "🎪 Sampling Distribution: Sample Size 100",
       x = "Sample Proportion of Dragons", 
       y = "Frequency",
       subtitle = "Red line shows true population proportion (0.30)") +
  theme_minimal()

# Calculate statistics
mean_proportion_100 <- mean(sample_proportions_100)
sd_proportion_100 <- sd(sample_proportions_100)

print(paste("📊 Average of sample proportions (size 100):", round(mean_proportion_100, 3)))
print(paste("📏 Spread (standard deviation) of sample proportions:", round(sd_proportion_100, 3)))
```

## 📊 The Great Comparison: All Sample Sizes Together!

```{r comparison}
# Combine all results
all_results <- rbind(
  data.frame(proportion = sample_proportions_10, sample_size = "Size 10"),
  data.frame(proportion = sample_proportions_50, sample_size = "Size 50"),
  data.frame(proportion = sample_proportions_100, sample_size = "Size 100")
)

# Create comparison plot
ggplot(all_results, aes(x = proportion, fill = sample_size)) +
  geom_histogram(bins = 15, alpha = 0.7, position = "identity") +
  geom_vline(xintercept = true_dragon_proportion, color = "red", linetype = "dashed", linewidth = 1) +
  facet_wrap(~sample_size, ncol = 1) +
  scale_fill_manual(values = c("lightblue", "lightgreen", "lightcoral")) +
  labs(title = "🌟 The Magic of Sample Size: All Distributions Compared",
       x = "Sample Proportion of Dragons", 
       y = "Frequency",
       subtitle = "Notice how larger samples cluster more tightly around the true value!") +
  theme_minimal() +
  theme(legend.position = "none")

# Summary table
summary_table <- data.frame(
  Sample_Size = c(10, 50, 100),
  Average_Proportion = c(mean_proportion_10, mean_proportion_50, mean_proportion_100),
  Spread_SD = c(sd_proportion_10, sd_proportion_50, sd_proportion_100),
  True_Proportion = rep(true_dragon_proportion, 3)
)

print("🏆 Summary of All Experiments:")
print(round(summary_table, 3))
```

## 🎯 Key Magical Discoveries!

**🔍 Discovery 1: The Law of Large Numbers**
- All sample sizes give us averages close to the true population proportion (0.30)
- Larger samples don't change the average, but they make it more reliable!

**📏 Discovery 2: Sample Size and Spread**
- **Small samples (10):** High variability - samples can be quite different from each other
- **Medium samples (50):** Medium variability - samples are more consistent
- **Large samples (100):** Low variability - samples are very consistent and close to truth

**🎪 Discovery 3: The Sampling Distribution Shape**
- All sampling distributions are roughly bell-shaped (normal)
- They all center around the true population value
- Larger sample sizes create narrower, more precise distributions

## 💡 Real-World Magic Applications

**🗳️ Political Polls:** When pollsters survey 1000 people instead of 100, their predictions are much more accurate!

**🎮 Game Testing:** Game companies test with large groups to get reliable feedback about what players really think.

**🍕 Restaurant Reviews:** A restaurant with 500 reviews gives you a better idea of quality than one with 5 reviews!

**⚕️ Medical Research:** Doctors test medicines on large groups to be confident about the results.

## 🎈 Your Turn: Real Candy Sampling!
Now let's connect this to our classroom candy bowl experiment! When you grab 10 green candies from the bowl, you're doing exactly what we just simulated - taking a sample to learn about the population!