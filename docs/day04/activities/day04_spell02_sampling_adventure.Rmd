---
title: "🔮 Day 4 - Spell 2: The Great Creature Sampling Adventure"
output: html_document
---

## 💡 What is Sampling?
Imagine you want to know how many dragons live in the entire Enchanted Forest, but you can't count them all! So you explore small areas, count the dragons there, and use that to guess about the whole forest. That's sampling!

**🌲 Population** = All the creatures in the entire Enchanted Forest (everything we want to know about)  
**🔍 Sample** = The creatures we find in one small area we explore (the small group we actually study)  
**📊 Statistic** = Something we calculate using our sample (like "30% of creatures in our sample are dragons")  
**🎯 Inference** = Using our sample to make a conclusion about the whole population

```{r setup}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
library(ggplot2)
library(dplyr)
library(infer)  # For rep_sample_n function
set.seed(123)  # For reproducible results
```

## 🐉 Our Magical Population: The Enchanted Forest
Let's create our population of 1000 magical creatures where exactly 30% are dragons!

```{r create-population}
# Create our population of 1000 creatures
# 300 dragons (30%) and 700 other creatures (70%)
magical_creatures <- tibble(
  creature_id = 1:1000,
  creature_type = factor(c(rep("dragon", 300), rep("other", 700)))
)

# Let's verify our true population proportion
true_dragon_proportion <- sum(magical_creatures$creature_type == "dragon") / nrow(magical_creatures)
print(paste("🎯 True proportion of dragons in population:", true_dragon_proportion))

# Visualize our population
population_summary <- magical_creatures %>%
  count(creature_type) %>%
  mutate(proportion = n / sum(n))

ggplot(population_summary, aes(x = creature_type, y = proportion, fill = creature_type)) +
  geom_bar(stat = "identity") +
  scale_fill_manual(values = c("dragon" = "red", "other" = "gray")) +
  labs(title = "🌲 True Population: Enchanted Forest Creatures",
       x = "Creature Type", 
       y = "Proportion",
       subtitle = "Population Size: 1000 creatures, 30% dragons") +
  theme_minimal() +
  theme(legend.position = "none")
```

## 🎣 Taking Our First Sample (Size 40)
Let's explore one area of the forest and see what creatures we find!

```{r first-sample}
# Take one random sample of 40 creatures
creature_sample_1 <- rep_sample_n(magical_creatures, size = 40)
creature_sample_1

# What's the proportion of dragons in our sample?
dragon_estimate_1 <- creature_sample_1 %>%
  summarize(count = sum(creature_type == "dragon"),
            proportion = sum(creature_type == "dragon") / 40)

print("🔍 Our first sample results:")
dragon_estimate_1
```

## 🎣 Taking Another Sample
What happens if we explore a different area of the forest? Will we get the same result?

```{r second-sample}
# Take another random sample of 40 creatures
dragon_estimate_2 <- rep_sample_n(magical_creatures, size = 40) %>%
  summarize(count = sum(creature_type == "dragon"),
            proportion = sum(creature_type == "dragon") / 40)

print("🔍 Our second sample results:")
dragon_estimate_2
```

## 🎣 And One More Sample!
Let's try once more to see the variability between samples:

```{r third-sample}
# Take a third random sample of 40 creatures
dragon_estimate_3 <- rep_sample_n(magical_creatures, size = 40) %>%
  summarize(count = sum(creature_type == "dragon"),
            proportion = sum(creature_type == "dragon") / 40)

print("🔍 Our third sample results:")
dragon_estimate_3
```

## 📊 The Sampling Distribution: Taking LOTS of Samples!
What if we explore 1000 different areas of the forest? Let's see what the distribution of our estimates looks like!

```{r sampling-distribution}
# Take 1000 samples of size 40 and calculate proportions for each
sampling_results <- rep_sample_n(magical_creatures, size = 40, reps = 1000) %>%
  group_by(replicate) %>%
  summarize(proportion = sum(creature_type == "dragon") / 40)

# Plot the sampling distribution
ggplot(sampling_results, aes(x = proportion)) +
  geom_histogram(binwidth = 0.05, fill = "lightblue", color = "black", alpha = 0.7) +
  geom_vline(xintercept = true_dragon_proportion, color = "red", linetype = "dashed", linewidth = 1) +
  labs(title = "🎲 Sampling Distribution: 1000 Samples of Size 40",
       x = "Sample Proportion of Dragons", 
       y = "Count",
       subtitle = "Red line shows true population proportion (0.30)") +
  theme_minimal()

# Calculate statistics about our sampling distribution
mean_proportion <- mean(sampling_results$proportion)
sd_proportion <- sd(sampling_results$proportion)

print(paste("📊 Average of all sample proportions:", round(mean_proportion, 3)))
print(paste("📏 Spread (standard deviation) of sample proportions:", round(sd_proportion, 3)))
print(paste("🎯 True population proportion:", true_dragon_proportion))
```

## 📊 The Magic of Sample Size: What If We Change Sample Size?
Let's see what happens when we use different sample sizes!

```{r sample-size-comparison}
# Compare different sample sizes: 20, 40, and 100
sample_sizes <- c(20, 40, 100)
all_results <- tibble()

for (size in sample_sizes) {
  results <- rep_sample_n(magical_creatures, size = size, reps = 1000) %>%
    group_by(replicate) %>%
    summarize(proportion = sum(creature_type == "dragon") / size,
              sample_size = paste("Size", size))
  
  all_results <- bind_rows(all_results, results)
}

# Create comparison plot
ggplot(all_results, aes(x = proportion, fill = sample_size)) +
  geom_histogram(binwidth = 0.05, alpha = 0.7) +
  geom_vline(xintercept = true_dragon_proportion, color = "red", linetype = "dashed", linewidth = 1) +
  facet_wrap(~sample_size, ncol = 1) +
  scale_fill_manual(values = c("lightcoral", "lightblue", "lightgreen")) +
  labs(title = "🌟 The Magic of Sample Size: All Distributions Compared",
       x = "Sample Proportion of Dragons", 
       y = "Count",
       subtitle = "Notice how larger samples cluster more tightly around the true value!") +
  theme_minimal() +
  theme(legend.position = "none")

# Calculate summary statistics
summary_stats <- all_results %>%
  group_by(sample_size) %>%
  summarize(
    Average_Proportion = mean(proportion),
    Spread_SD = sd(proportion),
    .groups = "drop"
  ) %>%
  mutate(True_Proportion = true_dragon_proportion)

print("🏆 Summary of All Experiments:")
print(summary_stats)
```

## 🎯 Key Magical Discoveries!

**🔍 Discovery 1: The Law of Large Numbers**
- All sample sizes give us averages close to the true population proportion (0.30)
- Larger samples don't change the average, but they make it more reliable!

**📏 Discovery 2: Sample Size and Spread**
- **Small samples (10):** High variability - samples can be quite different from each other
- **Medium samples (50):** Medium variability - samples are more consistent
- **Large samples (100):** Low variability - samples are very consistent and close to truth

**🎪 Discovery 3: The Sampling Distribution Shape**
- All sampling distributions are roughly bell-shaped (normal)
- They all center around the true population value
- Larger sample sizes create narrower, more precise distributions

## 💡 Real-World Magic Applications

**🗳️ Political Polls:** When pollsters survey 1000 people instead of 100, their predictions are much more accurate!

**🎮 Game Testing:** Game companies test with large groups to get reliable feedback about what players really think.

**🍕 Restaurant Reviews:** A restaurant with 500 reviews gives you a better idea of quality than one with 5 reviews!

**⚕️ Medical Research:** Doctors test medicines on large groups to be confident about the results.
