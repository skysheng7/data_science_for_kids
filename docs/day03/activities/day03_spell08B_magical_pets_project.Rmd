---
title: "ðŸ”® Day 3 - Spell 8B: Team Project - Magical Pets Mystery (uses magical_pets.csv)"
output: html_document
---

```{r setup-locale, include=FALSE}
Sys.setlocale("LC_CTYPE", "en_US.UTF-8")
```

---

## ðŸ§° Load tools and data

```{r}
library(dplyr)
library(ggplot2)
pets_data <- read.csv("../datasets/magical_pets.csv")

print("ðŸ” Evidence loaded from magical_pets.csv")
head(pets_data)
```

---

## ðŸŽ¯ Your missions (pick one or more)
1) Which favorite treat is most popular among pets?
2) Do pets who like that treat also tend to have higher magic levels?
3) Which pet type has the highest average magic level?
4) Are older pets more magical?
5) What does the distribution of magic levels look like?

---

## 1) Which favorite treat is most popular among pets?

```{r eval=FALSE}
# TODO: Fill in the ... below to solve the mysteries!

# count by favorite treat
treat_counts <- pets_data %>%
  group_by(favorite_treat) %>%
  summarize(count = ...) %>%
  arrange(desc(count))
print(treat_counts)

# bar plot to show how many pets like each treat
treat_bar <- ggplot(treat_counts, aes(x = ..., y = ...)) +
  geom_col(fill = "orange", color = "black") +
  labs(title = "Most Popular Favorite Treats",
       x = "Favorite Treat", y = "Number of Pets")+
  theme_minimal() +
  theme(text = element_text(size = 16),
        plot.title = element_text(size = 20),
        axis.title = element_text(size = 18),
        axis.text = element_text(size = 19),
        axis.text.x = element_text(angle = 60, hjust = 1))
print(treat_bar)
```

---

## 2) Do pets who like that treat also tend to have higher magic levels?

```{r eval=FALSE}
# Average magic by favorite treat 
# TODO: Fill in the ... below to solve the mysteries!
treat_magic <- pets_data %>%
  group_by(favorite_treat) %>%
  summarize(average_magic = mean(...)) %>%
  arrange(desc(average_magic))
print(treat_magic)

treat_magic_bar <- ggplot(treat_magic, aes(x = favorite_treat, y = ...)) +
  geom_col(fill = "purple", color = "black") +
  labs(title = "Average Magic by Favorite Treat",
       x = "Favorite Treat", y = "Average Magic Level")+
  theme_minimal() +
  theme(text = element_text(size = 16),
        plot.title = element_text(size = 20),
        axis.title = element_text(size = 18),
        axis.text = element_text(size = 19),
        axis.text.x = element_text(angle = 60, hjust = 1))
print(treat_magic_bar)
```

---

## 3) Which pet type has the highest average magic level?

```{r eval=FALSE}
# Average magic by pet type 
# TODO: Fill in the ... below to solve the mysteries!
type_magic <- pets_data %>%
  group_by(...) %>%
  summarize(average_magic = mean(magic_level), count = n()) %>%
  arrange(desc(average_magic))
print(type_magic)

type_magic_bar <- ggplot(type_magic, aes(x = pet_type, y = average_magic)) +
  geom_col(fill = "skyblue", color = "black") +
  labs(title = "Which Pet Type is the Most Magical?",
       x = "Pet Type", y = "Average Magic Level")+
  theme_minimal() +
  theme(text = element_text(size = 16),
        plot.title = element_text(size = 20),
        axis.title = element_text(size = 18),
        axis.text = element_text(size = 19),
        axis.text.x = element_text(angle = 60, hjust = 1))
print(type_magic_bar)
```

---

## 4) Are older pets more magical?

```{r eval=FALSE}
# TODO: Fill in the ... below to solve the mysteries!
pets_scatter <- ggplot(pets_data, aes(x = ..., y = ..., color = pet_type)) +
  geom_point(size = 4) +
  labs(title = "Are Older Pets More Magical?",
       x = "Age (years)", y = "Magic Level", color = "Pet Type")+
  theme_minimal() +
  theme(text = element_text(size = 16),
        plot.title = element_text(size = 20),
        axis.title = element_text(size = 18),
        axis.text = element_text(size = 19))
print(pets_scatter)
```

---

## 5) What does the distribution of magic levels look like?

```{r eval=FALSE}
# TODO: Fill in the ... below to solve the mysteries!
pets_magic_hist <- ggplot(pets_data, aes(x = ...)) +
  geom_histogram(fill = "...", color = "black") +
  labs(title = "Distribution of Pet Magic Levels",
       x = "Magic Level", y = "Number of Pets")+
  theme_minimal() +
  theme(text = element_text(size = 16),
        plot.title = element_text(size = 20),
        axis.title = element_text(size = 18),
        axis.text = element_text(size = 19))
print(pets_magic_hist)
```